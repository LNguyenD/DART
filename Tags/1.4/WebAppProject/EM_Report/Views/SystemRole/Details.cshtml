@model EM_Report.Domain.System_Roles
@using EM_Report.Helpers;
@using EM_Report.Common.Utilities;
@using EM_Report.Repositories;
@{
    ViewBag.Title = "System Role";
    Layout = Request.IsAjaxRequest() ? null : "~/Views/Shared/_Master.cshtml";
}
@functions {  
	public bool IsNew()
	{
		return (Model != null && Model.System_RoleId > 0) ? false : true;
	}

	public string AddButtonText()
	{
		return IsNew() ? "add" : "save";
	}
}
<link href="@Url.ContentV("~/Css/jquery.selectbox.css")" rel="stylesheet" type="text/css" />        
<script type="text/javascript" src="@Url.ContentV("~/scripts/custom_javascript.js")"></script> 
<script src="@Url.ContentV("~/scripts/iReport.js")" type="text/javascript"></script>
<link href="@Url.ContentV("~/Css/report.css")" rel="stylesheet" type="text/css" />
<div class="wrapper">
    <div class="w_100p">
        @using (Html.BeginForm())
        {
            @Html.AntiForgeryToken()
            <div class="formWrap">
                @Html.Hidden("action")
                @if (!IsNew())
                {
				    @Html.HiddenFor(e => e.System_RoleId)
                }                
                <h1>@(IsNew() ? "System Role Add" : "System Role Edit")</h1>
                @Html.Partial("_ShowMessage")
                        
                <div class="formInline">
                    <label>System Role Name</label>                    
                    @Html.TextBoxFor(e => e.Name, new { id = "txtName", name = "txtName", @class = "Text" })
				    @Html.ValidationMessageFor(e => e.Name) 
                </div>    
                <div class="clear"></div>           
                <div class="formInline">
                    <label>Description</label>
                    @Html.TextAreaFor(e => e.Description, new { id = "txtDescription", @class = "Text" })
				    @Html.ValidationMessageFor(e => e.Description) 
                </div>                
                <div class="clear"></div>
                <br />
                <h1>System Permissions</h1>
                <table id="tbGrid" name="tbGrid" cellspacing="0" cellpadding="0" class="tbl">
                    <thead>
                        <tr>
                            <th class="col_3 first center"><input type="checkbox" name="chkAll"/></th>
                            <td>System Permissions</td>
                            @foreach (var item in (SelectList)ViewBag.Permissions)
                            {
                                <td class="col_10 center">@item.Text</td>
                            }                              
                        </tr>
                    </thead>
                    @{
                        var i = 1;
                        <tbody>
                            @foreach (var item in (SelectList)ViewBag.System_Permissions)
                            {              
                                <tr class="@(i % 2 == 0 ? "even" : "odd")">
                                    <th class="center"><input type="checkbox" name="chkItemAll" value="@item.Value" /></th>
                                    <td>@item.Text</td>
                                    @foreach (var pItem in (SelectList)ViewBag.Permissions)
                                    {
                                        if (("," + (string)(ViewBag.I_Permissions) + ",").IndexOf("," + item.Value + "_" + pItem.Value + ",") >= 0)
                                        {
                                            <td><input checked="checked" type="checkbox" name="@("chkItem_" + item.Value)" value="@(item.Value + "_" + pItem.Value)" /></td>                      
                                        }
                                        else
                                        {
                                            <td><input type="checkbox" name="@("chkItem_" + item.Value)" value="@(item.Value + "_" + pItem.Value)" /></td>
                                        }
                                    }
                                </tr>
                                i++;
                            }                 		
                        </tbody>
                    }
                </table>  
                <br />              
                <div class="clear"></div>
                <div style="text-align:right !important">     
                    @if (Login.AuthorizeSystemPermission(ResourcesHelper.System_Report, ResourcesHelper.Permission_Add))
                    {     
                        <span class="btnPurple"><input type="button" id="cmdSave_SystemRole" value="Save" /></span>
                    }
                    <span class="btnPurple"><input type="button" onclick="window.location=('@Url.Action("Index", "SystemRole")')" value="Back To List" /></span>
                </div>
                <div class="clear" style="z-index: 4290;"></div>
                <input type="hidden" id="hddSystemPermission" name="hddSystemPermission" />
            </div>
        }
</div>
</div>