@*Start-Count time to access Dashboard Level*@
<script type="text/javascript" language="javascript">
    var count = 0;
    var starttime;
    var endtime;
    var url = $(location).attr('href');
    $(window).load(function () {
        saveStartTime();
    });


    $(window).bind('beforeunload', function () {
        count++;
        if (count == 1) {
            var currentTab = $('.tab_current');
            submitTimeInfo(currentTab);
        }
    });

    function saveStartTime() {
        var time = new Date();
        var year = time.getFullYear().toString();
        var month = (time.getMonth() + 1).toString();
        var day = time.getDate().toString();
        var hour = time.getHours().toString();
        var minutes = time.getMinutes().toString();
        var seconds = time.getSeconds().toString();
        starttime = year + "-" + month + "-" + day + " " + hour + ":" + minutes + ":" + seconds;
    }

    function submitTimeInfo(currentTab) {
        var time = new Date();
        var year = time.getFullYear().toString();
        var month = (time.getMonth() + 1).toString();
        var day = time.getDate().toString();
        var hour = time.getHours().toString();
        var minutes = time.getMinutes().toString();
        var seconds = time.getSeconds().toString();
        endtime = year + "-" + month + "-" + day + " " + hour + ":" + minutes + ":" + seconds;

        var reportPath = getParameterByName('reportpath');
        var url = reportPath;

        if (document.URL.toLowerCase().indexOf('rtw') > -1) {
            url = url.replace('_agency', '').replace('_group', '')
                       .replace('_employer_size', '').replace('_portfolio', '')
                       .replace('_account_manager', '');
        }

        //var currentTab = $('.tab_current');
        if (currentTab.length > 0) {
            type = currentTab.attr('id').replace('tab_', '');
            if (reportPath.toLowerCase().indexOf('eml') > -1) {
                type = type.replace('agencies','employer_size');
            }
            else if (reportPath.toLowerCase().indexOf('hem') > -1) {
                type = type.replace('agencies','portfolio');
            }

            url += '_' + type;
        }
        else {
            type = getParameterByName('type');
            if (type !== '') {
                url += '_' + type;
            }
        }

        $.ajax({
            async: false,
            type: 'POST',
            headers: generateAntiForgeryTokenHeader(),
            url: '@Url.Action("Details", "Dashboard_TimeAccess")',
            data:
                {
                    url: url,
                    starttime: starttime,
                    endtime: endtime,
                },
            success: function () { }
        });
    }

</script>
@*End-Count time to access Dashboard Level*@