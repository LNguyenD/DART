@model List<EM_Report.Domain.User>
@using EM_Report.Common.Utilities;
@using EM_Report.Helpers;
@using EM_Report.Domain.Resources;
@{
    ViewBag.Title = "User";
    ViewBag.Heading = "User >> User list";
    Layout = Request.IsAjaxRequest() ? null : "~/Views/Shared/_Master.cshtml";   
}
<div class="wrapper">
    @using (Ajax.BeginForm("Index", new AjaxOptions { UpdateTargetId = "content", OnBegin = "showLoading", OnComplete = "hideLoading" }))
    {
        @Html.AntiForgeryToken()
        <link href="@Url.ContentV("~/Css/jquery.selectbox.css")" rel="stylesheet" type="text/css" />        
        <script type="text/javascript" src="@Url.ContentV("~/scripts/custom_javascript.js")"></script> 
        <script src="@Url.ContentV("~/scripts/iReport.js")" type="text/javascript"></script>
        <link href="@Url.ContentV("~/Css/report.css")" rel="stylesheet" type="text/css" />  
        @Html.Partial("_SearchBar")
        <div class="w_100p">
            <div class="formWrap">
                <h1>User List</h1>
                <hr />
                <br />
                <table id="tbGrid" name="tbGrid" style="width: 100%;">
                    @{ 
                        if (!ViewData.Model.IsNullOrEmpty())
                        {
                            int i = 0;
                            var list_Users = Model;
                            while (i < list_Users.Count())
                            {                        
                                <tr style="margin-bottom: 50px;">
                                @{
                                    if (i < list_Users.Count())
                                    {
                                        for (int j = 0; j < 3; j++)
                                        {
                                            if (i < list_Users.Count())
                                            {  
                                              <td style="width: 33.3%" valign="top">
                                                    <table style="border: 0; width: 100%">
                                                        <tr>
                                                            <td valign="top" style="width: 8%">
                                                                <table style="border: 0;">
                                                                    <tr>
                                                                        <td>
                                                                            <input type="image" src="@Url.ContentV("~/images/ico_user.png")" />
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td>
                                                                            <input type="checkbox"  name="chkItem" value="@list_Users.ElementAt(i).UserId" id="chkId@(i)" style="float: left; margin-left: 20px;"/>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                            <td valign="top" style="width: 90%; vertical-align: top;">
                                                                <table style="border: 0; width: 100%" id="tbWrapper_User">
                                                                    <tr>
                                                                        <td>
                                                                            <b>@(list_Users.ElementAt(i).FirstName + " " + list_Users.ElementAt(i).LastName)</b>
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td>
                                                                            <b>User Name:</b> <a href="@Url.Action("details", "user", new { id = list_Users.ElementAt(i).UserId, systemid = ViewBag.currentSystemId })">@(list_Users.ElementAt(i).UserName)</a>
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td>
                                                                            <b>Email:</b><a href="mailto:@(list_Users.ElementAt(i).Email)" > @(list_Users.ElementAt(i).Email)
                                                                            </a>
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td>
                                                                            <b>Phone:</b> @(list_Users.ElementAt(i).Phone)
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td>
                                                                            <b>User Type:</b> @(list_Users.ElementAt(i).Is_System_User ? "System" : "Report")
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td>
                                                                            <b>Status:</b> @(list_Users.ElementAt(i).StatusName)
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </td>                                                
                                            }
                                            i++;
                                        }
                                    }   
                                }
                                </tr>
                                <tr>
                                    <td colspan="3" style="height: 30px;">
                                    </td>
                                </tr>
                            }
                        } 
                    }
                </table>
                <hr />
                <div class="right">
                    @if (Login.AuthorizeSystemPermission(ResourcesHelper.System_User, ResourcesHelper.Permission_Add))
                    {
                        <span class="btnPurple">
                            <input type="button" value="@Resource.Action_AddNew" onclick="window.location = ('@Url.Action("details", "user", new { systemid = ViewBag.currentSystemId })')"/></span>
                    }
                    @if (Login.AuthorizeSystemPermission(ResourcesHelper.System_User, ResourcesHelper.Permission_Update))
                    {
                        <span class="btnPurple">
                            <input type="button" id="cmdActive" value="@ResourcesHelper.Action_Active" /></span>
                        <span class="btnPurple">
                            <input type="button" id="cmdInActive" value="@ResourcesHelper.Action_InActive" /></span> 
                    }
                </div>
                <div class="Paging">
                    @if (!Model.IsNullOrEmpty())
                    {
                        @Html.Partial("_UCPaging")                                          
                    }
                </div>
                @Html.Partial("_HiddenAction")
                <div class="clear"></div>
            </div>
            <div class="clear">
            </div>
        </div>
  
    }
</div>
<script type="text/javascript" language="javascript">
    $(document).ready(function () {
        $('#selectcboSystem').hide();
    });
</script>
